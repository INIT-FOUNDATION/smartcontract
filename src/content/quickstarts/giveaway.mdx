---
section: automation
date: Last Modified
title: Giveaway Manager
whatsnext: { "FAQs": "/chainlink-automation/faqs" }
---

import { Aside, ClickToZoom, CopyText } from "@components"

The Giveaway Manager app is a highly configurable proof of concept for provably-fair giveaways using Chainlink Automation and VRF. It is capable of drawing winners from a CSV list or onchain entries using VRF Direct Funding and Automation. Fulfillment is not included, and this app demonstrates provably fair selection only.

![image](https://i.imgur.com/lCIAVrR.png)

## Objective

In this tutorial, you will deploy a local user interface to enable giveaways using Chainlink VRFv2 Direct Funding. The UI was designed to run simple drawings and giveaways with just a CSV list of participants. Chainlink Automation provisioning and setup is also covered to enable timed-based, dynamic drawings.

You can use this to run:

- Static Giveaways: Fairly and transparently pick winners from a participant list in CSV format. Unique participant IDs can be anything (emails, numbers, addresses). They are hashed so no user data is stored on-chain.
- Dynamic Giveaways: Create a giveaway that participants can enter on their own via tx, then fairly and transparently pick winners whenever you'd like. This allows participants to register over a set period of time without the admin needing a full participant list like a static giveaway.

<Aside type="caution" title="Disclaimer">
  This tutorial represents an example of using a Chainlink product or service and is provided to help you understand how
  to interact with Chainlink's systems and services so that you can integrate them into your own. This template is
  provided “AS IS” and “AS AVAILABLE” without warranties of any kind, has not been audited, and may be missing key
  checks or error handling to make the usage of the product more clear. Do not use the code in this example in a
  production environment without completing your own audits and application of best practices. Neither Chainlink Labs,
  the Chainlink Foundation, nor Chainlink node operators are responsible for unintended outputs that are generated due
  to errors in code.
</Aside>

## Before you begin

<Aside type="note" title="New to smart contract development?">
  If you are new to smart contract development, learn how to [Deploy Your First Smart
  Contract](/getting-started/deploy-your-first-contract).
</Aside>

Before you start this tutorial, complete the following items:

- Set up a cryptocurrency wallet such as [MetaMask](https://metamask.io/).
- Fund your wallet with the following testnet tokens:
  - Get testnet MATIC from [faucet.polygon.technology](https://faucet.polygon.technology) to pay for your on-chain transactions.
  - Get at least 2 ERC-677 testnet LINK from [faucets.chain.link/mumbai](https://faucets.chain.link/mumbai).

## Setup steps

Setting up the app requires several steps:

1. [Clone the repo](#clone-repo)
1. [Create a block explorer API key](#create-a-block-explorer-api-key)
1. [Set contract environment variables](#set-contract-environment-variables)

### Clone the repo

- Run `git --version` to check your `git` installation. You should see an output similar to `git version x.x.x`. If not, install [git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git).
- Install [NodeJS](https://nodejs.org/)
- Install [yarn](https://yarnpkg.com/)

```bash
$ git clone https://github.com/smartcontractkit/quickstart-giveaway.git
```

### Create a block explorer API key

The recommended networks for this app are Ethereum or Polygon mainnet and testnets.

For demo purposes, use Polygon Mumbai for this tutorial. Create a block explorer API key to verify contracts on your preferred network:

- [Etherscan](https://docs.etherscan.io/getting-started/viewing-api-usage-statistics)
- [Polygonscan](https://docs.polygonscan.com/getting-started/viewing-api-usage-statistics)

### Set contract environment variables

1. Prepare the following values:

   - The RPC URL for your deployment network, using an [RPC node provider](https://ethereum.org/en/developers/docs/nodes-and-clients/nodes-as-a-service/) such as [Infura](https://www.infura.io/) or [Alchemy](https://www.alchemy.com/).
   - The private key for your deployer account. If your deployer account is in MetaMask, [export your private key from MetaMask](https://support.metamask.io/hc/en-us/articles/360015289632-How-to-export-an-account-s-private-key).
   - The block explorer API key from Etherscan or Polygonscan that you [created earlier](#create-a-block-explorer-api-key).

   | Parameter         | Description                                                  | Example                                     |
   | ----------------- | ------------------------------------------------------------ | ------------------------------------------- |
   | `NETWORK_RPC_URL` | The RPC URL for the network you want to deploy to.           | `https://sepolia.infura.io/v3/your-api-key` |
   | `PRIVATE_KEY`     | The private key of the account you want to deploy from.      | `0xabc123abc123abc123abc123abc123...`       |
   | `EXPLORER_KEY`    | The block explorer API key needed for contract verification. | `ABC123ABC123ABC123ABC123ABC123ABC1`        |

1. In the `contracts` directory, create a `.env` file for your contract environment variables:

   ```bash
   # <root>/contracts
   $ touch .env
   $ open .env
   ```

   If you're going to push this to your own repo, make sure this `.env` file is untracked, and consider using a secure env management package instead.

1. Add this content to your file and fill in the values. Do not use quotation marks when filling in the values.

   ```bash
   # Do NOT use quotes to assign values!

   # Network RPCs
   export RPC_URL=

   # Private key for contract deployment
   export PRIVATE_KEY=

   # Explorer API key used to verify contracts
   export EXPLORER_KEY=
   ```

### Install Foundry

Refer to the [Foundry installation instructions](https://book.getfoundry.sh/getting-started/installation).

1. Download foundryup:

   ```bash
   # Download foundry
   $ curl -L https://foundry.paradigm.xyz | bash
   ```

1. Restart your terminal session, then install Foundry by running:

   ```bash
   foundryup
   ```

   <Aside type="note" title="MacOS installation note">
     You might see the following error on MacOS: `dyld: Library not loaded:
     /usr/local/opt/libusb/lib/libusb-1.0.0.dylib`. To fix this, install libusb: `brew install libusb` See [installation
     troubleshooting](https://github.com/foundry-rs/foundry/blob/master/README.md#troubleshooting-installation) for
     details.
   </Aside>

### Install contract dependencies

If you don't have `make` install it.

Install contract dependencies if changes have been made to contracts:

```bash
# <root>/contracts
$ make install
```

### Deploy contract

```bash
# <root>/contracts
$ make deploy
```

Save the deployed contract address from your terminal output. This is the giveaway contract manager address that you will need when you [run the UI](#run-ui).

### Install UI dependencies

To install the UI dependencies, navigate to the `client` directory and run:

```bash
# <root>/client
# (Mac) you may need to run 'source ~/.nvm/nvm.sh'
$ nvm use
$ yarn
```

### Run and view the UI

Set environment variables to run the UI and then view it locally.

1. Prepare your UI environment variables. These are needed for each time you want to run the UI:

   | Item                                   | Value                                                                                                                                                                                                                                |
   | -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | `UI_GIVEAWAY_MANAGER_CONTRACT_ADDRESS` | The address of the Giveaway Contract Manager contract that you [deployed earlier](#deploy-contract)                                                                                                                                  |
   | `UI_LINK_TOKEN_CONTRACT_ADDRESS`       | <CopyText text="0x779877A7B0D9E8603169DdbD7836e478b4624789" code/> <br/> See all [LINK token contract addresses](/resources/link-token-contracts)                                                                                    |
   | `UI_KEEPER_REGISTRY_CONTRACT_ADDRESS`  | For Polygon Matic: <CopyText text="0x02777053d6764996e594c3E88AF1D58D5363a2e6" code/> <br/> This app currently supports Automation v1.2. See all [Automation registry contract addresses](/chainlink-automation/supported-networks/) |

1. Navigate to the `/client/packages/ui` directory, and run these commands to set up your UI environment variables. Do not use quotes to assign values:
   ```bash
   # <root>/client/packages/ui
   export UI_GIVEAWAY_MANAGER_CONTRACT_ADDRESS=
   export UI_LINK_TOKEN_CONTRACT_ADDRESS=
   export UI_KEEPER_REGISTRY_CONTRACT_ADDRESS=
   ```
1. After setting the environment variables, run the UI locally:
   ```bash
   yarn start
   ```
1. To view the UI, open your browser at [localhost:3005](localhost:3005).

### Testing

To test contracts, navigate to the `contracts` directory and run the following command:

```bash
# <root>/contracts
make test-contracts-all
```

To test the UI, navigate to the `/client/packages/ui` directory and run the following commands:

```bash
# <root>/client/packages/ui
$ yarn test
$ yarn tsc
$ yarn lint
$ yarn prettier
```

## Implement a static giveaway

1. Navigate to http://localhost:3005/ in your browser.
1. In the upper right corner, click **Connect wallet**. Connect your wallet and ensure the proper network is selected.

   <ClickToZoom src="/images/quickstarts/giveaway/1-ui-connect-wallet.png" alt="Connect wallet" />

1. Click **Create giveaway**.

   <ClickToZoom src="/images/quickstarts/giveaway/2-ui-create-giveaway.png" alt="Create giveaway" />

1. Static giveaway is selected by default. Fill in the details to configure the giveaway:

   - Create a CSV file with a list of giveaway participants. Below the **Participants** field, download the example CSV participant file and fill it in. For testing, you can use a list of dummy wallet addresses.
   - Fill in the rest of the fields and upload your CSV list of participants, then **Create** and confirm the wallet transaction that pops up.

   {" "}
   <ClickToZoom src="/images/quickstarts/giveaway/3-ui-create-static-giveaway.png" alt="Create static giveaway" />

1. After the transaction processes, you should get a "Giveaway successfully created" message. Click the UI card for the new giveaway you just created:

   <ClickToZoom src="/images/quickstarts/giveaway/4-ui-click-giveaway.png" alt="Click the newly created giveaway" />

1. The details for your giveaway are displayed. Click **Pick Winners** and confirm the wallet transaction.

   <ClickToZoom src="/images/quickstarts/giveaway/5-ui-pick-winners.png" alt="Pick winners" />

1. A "Pending Transaction" popup displays while the transaction is processing. Once the transaction is complete, you should see a "Successfully picked winners" message. Click **Close**.

   - Optional: You can reference the "View VRF Request" link to help prove the giveaway was fair.

   <ClickToZoom src="/images/quickstarts/giveaway/6-ui-pick-winners-confirmation.png" alt="Pick winners confirmation" />

1. At the bottom of the Giveaway page, upload your original participants (contestants) CSV again to see who won:

   <ClickToZoom src="/images/quickstarts/giveaway/7-ui-upload-contestants-csv.png" alt="Upload contestants CSV" />

1. After you've uploaded the CSV, click **Check Winners**:

   <ClickToZoom src="/images/quickstarts/giveaway/8-ui-check-winners.png" alt="Check winners" />

1. A **Giveaway winners** popup displays and shows the winners. This demo used a CSV of dummy wallet addresses. You can use whatever unique identifier you want. Since the identifier is hashed before it's put on-chain, the data remains private to only you as the admin.

   <ClickToZoom src="/images/quickstarts/giveaway/9-ui-giveaway-winners.png" alt="View winners" />

   You can export a CSV list of all the winners and share the list with participants if you wish. You can also choose to provide the VRF transaction from Step 7 as evidence that Chainlink VRF was used for fairness.

## Notes

### Required balance amounts

As a creator of a giveaway, the minimum token requirements are needed to ensure that your giveaway is created and finished without issues. All unused LINK token amounts are able to be withdrawn after completion of giveaway.

- 5.1 LINK
  - 0.1 (VRF request)
  - 5 (Automation subscription)

### Giveaway Status

After picking winners is initiated in the UI, the status of the giveaway is moved to `pending`. Each subsequent block is then checked to see if the VRF request has been finished and winners picked. Once found, the status is automatically moved to `finished`. The winners are then able to be viewed and leftover LINK is able to be withdrawn.

### Developer Integration for Entering Dynamic Giveaway

The Giveaway contract is able to be integrated with any application that is able to send a transaction to the contract. The user will need to call the `enterGiveaway` function with the following parameters:

- `giveawayId` - The ID of the giveaway that the user is entering
- `entries` - The amount of entries the user is purchasing
- `proof` The merkle proof of the user's entry if the giveaway is permissioned

This is how the UI in this repo calls the `enterGiveaway` function using `wagmi`:

```javascript
export const enterGiveaway = async (params: contracts.EnterGiveawayParams) => {
  try {
    const { id, proof, fee } = params
    const config = await prepareWriteContract({
      address: giveawayManagerContractAddress,
      abi: giveawayManagerABI,
      functionName: 'enterGiveaway',
      overrides: {
        value: ethers.utils.parseEther(fee)
      },
      args: [id, params.entries ? params.entries : 1, proof ? proof : []]
    })
    const data = await writeContract(config)
    return data
  } catch (error: any) {
    throw new Error(`Error entering giveaway: ${error.message}`)
  }
}

export interface EnterGiveawayParams {
  id: number
  entries?: number
  proof?: string[]
  fee: string
}
```
